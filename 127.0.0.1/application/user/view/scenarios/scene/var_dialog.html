<div class="modal fade in" id="record_compose2" tabindex="1" data-backdrop="static" data-keyboard="false" aria-hidden="true"
 role="dialog" aria-labelledby="myLargeModalLabel">
	<div class="modal-dialog" style="width:890px;">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">×</span>
				</button>
				<h4 class="modal-title">合成录音</h4>
			</div>
			<div class="modal-body" style="max-height: 510px !important;">
				<div class="showtop">
					<div class="com_title">音频配置</div>
					<div class="showtopdata composedata">
						<div class="flex">
							<div class="composedata">
								<label class="text-right control-label">发音场景：</label>
								<div class="col-lg-9 col-sm-9">
									<select class="form-control ttfw" name="pro_scene" id="voice_2">
                    <option value="Aixia">艾夏 亲和女声 客服场景</option>
										<option value="Aiyue">艾悦 温柔女声 客服场景</option>
										<option value="Aibao">艾宝 萝莉女声 童声场景</option>
										<option value="Aicheng">艾诚 标准男声 通用场景</option>
										<option value="Aida">艾达 标准男声 通用场景</option>
									</select>
								</div>
							</div>
							<div class="composedata margintop20">
								<label class="text-right control-label">音量：</label>
								<div class="col-lg-9 col-sm-9">
									<div class="new-slider">
										<label>0</label>
										<div id="slider-range-min_2">
											<label id="amount_2" class="ui-text"></label>
										</div>
										<label>100</label>
									</div>
								</div>
							</div>
							<div class="composedata margintop20">
								<label class="text-right control-label">语速：</label>
								<div class="col-lg-9 col-sm-9">
									<div class="new-slider">
										<label>-500</label>
										<div id="slider-range-rate_2">
											<label id="amount-rate_2" class="ui-text"></label>
										</div>
										<label>500</label>
									</div>
								</div>
							</div>
						</div>
						<div class="flex">
							<div class="composedata">
								<label class="text-right control-label">音频采样率：</label>
								<div class="col-lg-9 col-sm-9">
									<select class="form-control ttfw" name="pro_scene" id="sampleRate_2">
										<option value="8000">8000HZ</option>
									</select>
								</div>
							</div>
							<div class="composedata margintop20">
								<label class="text-right control-label">语调：</label>
								<div class="col-lg-9 col-sm-9">
									<div class="new-slider">
										<label>-500</label>
										<div id="slider-range-tone_2">
											<label id="amount-tone_2" class="ui-text"></label>
										</div>
										<label>500</label>
									</div>
								</div>
							</div>
							<div class="composedata margintop20">
								<label class="text-right control-label">编码格式：</label>
								<div class="col-lg-9 col-sm-9">
									<label class="control-label" id="format">WAV</label>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="showbottom composedata align-items">
					<div class="showbtleft">
						<div class="com_title">
							文字内容
							<a class="pull-right n_inputfile" onclick="content_input();"><img src="__PUBLIC__/img_sj/xiazai_2.png" alt="" />批量导入</a>
						</div>
						<div class="showtopdata contents pz_innerbox">
							<div class="showbtleftdata">
								<textarea class="form-control ttfw" id="one_text" style="height:auto;resize: none;" name="text" placeholder="请输入文本"></textarea>
								<a href="javascript:;" onclick="add_word();">
									<img src="__PUBLIC__/img_sj/tianjia.png" alt="" />
								</a>
							</div>
						</div>
					</div>
					<div class="showbtcenter">
						<img src="__PUBLIC__/img_sj/jiantou_record.png" alt="" />
						<p>
							<button type="button" class="btn btn-primary" onclick="start_compose_2(this);">开始合成</button>
						</p>
					</div>
					<div class="showbtright pz_innerbox_lay">
						<div class="com_title">生成列表</div>
						<div class="showtopdata progressdata pz_innerbox">
							<div class="showbtrightdata clearfix" id="voice_volist_10">
								<!-- <p>文本内容</p>-->
								<!-- <div class="progress clearfix">-->
								<!-- <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em;">0%</div>-->
								<!--</div>-->
								<!--<div class="composedata align-items">-->
								<!-- <audio src="/uploads/audio/20181217/20181128031028.wav" preload="preload" controls="controls"></audio>-->
								<!-- <a href="javascript:;" onclick="audio_del(this);"><img src="__PUBLIC__/img_sj/shanchu.png" alt="" /></a>-->
								<!--</div>-->
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-primary" onclick="save_config_redis();">保存</button>
			</div>
		</div>
		<!--录音文字正在合成中弹窗-->
		<div class="l_loadfixed">
			<div class="l_loaddata">
				<p>
					<img src="__PUBLIC__/img_sj/reload.gif" alt="">文本合成中...</p>
				<p>文本正在合成中，请不要关闭页面。</p>
			</div>
		</div>
		<!--/录音文字正在合成中弹窗-->
	</div>
	<script id="voice-list_2" type="text/template">
     <div>
       <p> {%voice_name%} </p>
			<div class="composedata align-items">
				<audio src="/{%voice_url%}" preload="preload " controls="controls "></audio>
				<a href="javascript:;" onclick="audio_del(this);"><img src="__PUBLIC__/img_sj/shanchu.png" alt="" /></a>
			</div>
		</div>
    </script>
	 <script>
    // $(function () {
    //       $('#slider1').slider(function (per) {
    //           $('#sliderValue').text(per+'kg');
    //           $('#slider1 .handler').text(per)
    //       });
    //   });
    function start_compose_2(obj) {
        //获取杂项
        var data = {};
        data.voice = $("#voice_2  option:selected").val();
        data.volume = $('#amount_2').text();
        data.speech_rate = $("#amount-rate_2").text();
        data.pitch_rate = $('#amount-tone_2').text();
        data.format = 'wav';
        // $('#format').text();
        data.sampleRate = $('#sampleRate_2 option:selected').val();
        var text = [];
        $("textarea[name ='text']").each(function () {
            if ($(this).val() != '') {
                text.push($(this).val());
            }
        })
        if (text.length != 0) {
            $(obj).text('合成中');
            $('.l_loadfixed').show();
            data.text = text;
            console.log(data);
            var url = "{:url('Scenarios/synthesisVoice')}"
            $.ajax({
                url: url,
                dataType: "json",
                type: "post",
                data: data,
                success: function (data) {
                    console.log(data);
                    $(obj).text('开始合成');
                    if (data.code == 1) {
                        alert(data.msg);
                        $('.l_loadfixed').hide();
                        var jsonVoice = $.cookie(data.data)
                        var person = eval("(" + jsonVoice + ")");
                        console.log(person);
                        var htmls = '';
                        $.each(person, function (index, object) {
                            var html = $('#voice-list_2').html();
                            html = html.replace('{%voice_name%}', object.text);
                            html = html.replace('{%voice_url%}', object.audioSaveFile);
                            htmls += html;
                        })
                        $('#voice_volist_10').html(htmls);
                        window.uid = data.data
                    }
                },
                error: function () {
                    alert('参数错误');
                    $('.l_loadfixed').hide();
                }
            });
        } else {
            alert('文本内容不能为空')
        }
    }
    </script>
</div>
